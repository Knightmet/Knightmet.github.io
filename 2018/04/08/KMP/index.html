<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>KMP算法 | 追风的少年</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">KMP算法</h1><a id="logo" href="/.">追风的少年</a><p class="description">满目青山空念远 不如惜取眼前人</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">KMP算法</h1><div class="post-meta">Apr 8, 2018<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#分析"><span class="toc-number">1.</span> <span class="toc-text">分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#证明一下-当P-k-处失配时，P-1-P-2-…P-k-1-t-j-k-1-t-j-k-2-…t-j-1"><span class="toc-number">2.</span> <span class="toc-text">证明一下:当P[k]处失配时，P[1]P[2]…P[k-1] == t[j-k+1]t[j-k+2]…t[j-1]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#z满足：-P-1-P-2-…P-z-1-P-k-z-1-P-k-z-2-…P-k-1"><span class="toc-number">3.</span> <span class="toc-text">z满足： P[1]P[2]…P[z-1] == P[k-z+1]P[k-z+2]…P[k-1]</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#求Nexts数组"><span class="toc-number">3.1.</span> <span class="toc-text">求Nexts数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KMP"><span class="toc-number">3.2.</span> <span class="toc-text">KMP</span></a></li></ol></li></ol></div></div><div class="post-content"><a id="more"></a>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>KMP是求字符串匹配的算法，由大牛克努特，莫里斯，普莱特于1977年提出，之前好像还有一个MP算法，想了解的朋友可以去网上查一下资料。</p>
<p>对于字符串匹配 设主串T(t1,t2…tm) 检索子串P（p1,p2,…pn) 初学者的第一思路应该是从两个字符串的第一个字符开始比，如果相同，两个字符数组的下标同时加1，不同的话，主串的下标加1，模式串的下标归为1,因为每次比较一旦失败，模式串下标都要回溯，这样子的时间复杂度是O((n-m)* m)。由此，便考虑是否存在一种匹配方式，使得在主串中查找模式串时，匹配失败子串不必回溯，这样可以大大提高效率。KMP算法应运而生，它使用了一个Nest数组来储存模式串中每个字符的最大匹配程度。</p>
<p>举个栗子：</p>
<table>
<thead>
<tr>
<th style="text-align:center">字符数组为</th>
<th>c</th>
<th>a</th>
<th>c</th>
<th>a</th>
<th>b</th>
<th>c</th>
<th>a   </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">  <strong> Next [i] : </strong></td>
<td><strong> -1 </strong></td>
<td><strong> 0 </strong></td>
<td><strong> 0 </strong></td>
<td><strong> 1 </strong></td>
<td><strong> 2 </strong></td>
<td><strong> 0</strong></td>
<td><strong> 1 </strong></td>
</tr>
</tbody>
</table>
<p> 其中下标为0的地方默认为-1，方便运算 后面的每一个值为它及自己前面的字符与开头的字符匹配的最大长度 放出公式：Next[i]=Max(k)<br>k满足 p1p2…p(k-1) == p(i-k+1)p(i-k+2)…p(i-1)  </p>
<p>求得Next数组以后，在匹配过程中遇到匹配失败的情况时，另主串不动，模式串下标移动到它的Next数组的值处， 即另j=Next[j], 继续匹配。</p>
<h2 id="证明一下-当P-k-处失配时，P-1-P-2-…P-k-1-t-j-k-1-t-j-k-2-…t-j-1"><a href="#证明一下-当P-k-处失配时，P-1-P-2-…P-k-1-t-j-k-1-t-j-k-2-…t-j-1" class="headerlink" title="证明一下:当P[k]处失配时，P[1]P[2]…P[k-1] == t[j-k+1]t[j-k+2]…t[j-1]"></a>证明一下:当P[k]处失配时，P[1]P[2]…P[k-1] == t[j-k+1]t[j-k+2]…t[j-1]</h2><h2 id="z满足：-P-1-P-2-…P-z-1-P-k-z-1-P-k-z-2-…P-k-1"><a href="#z满足：-P-1-P-2-…P-z-1-P-k-z-1-P-k-z-2-…P-k-1" class="headerlink" title="z满足： P[1]P[2]…P[z-1] == P[k-z+1]P[k-z+2]…P[k-1]"></a>z满足： P[1]P[2]…P[z-1] == P[k-z+1]P[k-z+2]…P[k-1]</h2><p>只要找到z值,另P的下标转换为z即可继续进行匹配<br>由于Next数组已经求出模式串P的最大匹配程度，这个z值便是我们所求的Next的数组的值，是不是感觉很奇妙呀~~~</p>
<p>贴上代码</p>
<h3 id="求Nexts数组"><a href="#求Nexts数组" class="headerlink" title="求Nexts数组"></a>求Nexts数组</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">void getNext(char *p,int *next)&#123;</span><br><span class="line">	Next[0]=-1;</span><br><span class="line">	int i=0,j=-1;</span><br><span class="line">	while(i&lt;strlen(p))&#123;</span><br><span class="line">		if(j==-1 || p[i]==p[j])&#123;</span><br><span class="line">			i++;</span><br><span class="line">			j++;;</span><br><span class="line">			next[i]=j;</span><br><span class="line">		&#125;</span><br><span class="line">		else</span><br><span class="line">		j=next[j];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">int KMP(char *t,char *p)&#123;</span><br><span class="line">	int i=0;</span><br><span class="line">	int j=0;</span><br><span class="line">	int tl=strlen(t),pl=strlen(p);</span><br><span class="line">//	cout&lt;&lt;strlen(t)&lt;&lt;&apos; &apos;&lt;&lt;strlen(p)&lt;&lt;endl;</span><br><span class="line">	while(i&lt;tl &amp;&amp; j&lt;pl) &#123;</span><br><span class="line">		if(j==-1 || t[i]==p[j])&#123;</span><br><span class="line">			i++;</span><br><span class="line">			j++;</span><br><span class="line">		&#125;</span><br><span class="line">		else</span><br><span class="line">			j=Next[j];</span><br><span class="line">	&#125;</span><br><span class="line">//	cout&lt;&lt;i&lt;&lt;&apos; &apos;&lt;&lt;j&lt;&lt;endl;</span><br><span class="line">	if(j==strlen(p))</span><br><span class="line">	return i-j;</span><br><span class="line">	else</span><br><span class="line">	return -1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>参考文献</code> <a href="https://www.zhihu.com/question/21923021" target="_blank" rel="noopener">知乎”海纳”的回答</a></p>
</div><iframe src="/donate/?AliPayQR=http://p3d2hjqjf.bkt.clouddn.com/alipay.png&amp;WeChatQR=null&amp;GitHub=null&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden; overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><div class="tags"><a href="/tags/算法/">算法</a></div><div class="post-nav"><a class="pre" href="/2018/04/21/JavaWeb环境配置/">JavaWeb环境配置</a><a class="next" href="/2018/03/01/lanqiao-1/">蓝桥杯-带分数</a></div><div id="uyan_frame"></div><script type="text/javascript" src="//v2.uyan.cc/code/uyan.js?uid=2156903"></script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/IOT/" style="font-size: 15px;">IOT</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/05/17/物联网决赛-苏州/">全国高校物联网应用创新大赛-苏州之行</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/21/JavaWeb环境配置/">JavaWeb环境配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/08/KMP/">KMP算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/01/lanqiao-1/">蓝桥杯-带分数</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/30/建站小得/">建站小得</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://weibo.com/5672108993/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo" title="Sina Weibo" target="_blank">Sina Weibo</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">追风的少年.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>